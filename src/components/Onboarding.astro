---
import { Sparkles, MessageSquare, FileText, ChevronLeft, ChevronRight, Zap } from "@lucide/astro";

const onboardingQuestions = [
  { question: "What's your name?", placeholder: "Type your name..." },
  { question: "What are your main work areas?", placeholder: "e.g., Web development, AI/ML..." },
  { question: "What are you currently building?", placeholder: "Describe your current project..." },
  { question: "What do you want to achieve this week?", placeholder: "Your goals..." },
  { question: "Which agents would be most useful?", placeholder: "e.g., /research, /opencode..." }
];
---

<section class="relative py-20 md:py-28">
  <!-- Subtle gradient background -->
  <div class="absolute inset-0 bg-gradient-to-b from-[var(--background)] via-[#0c0c0c] to-[var(--background)]"></div>

  <div class="relative mx-auto max-w-6xl px-6">
    <div class="grid gap-12 md:grid-cols-2 md:gap-16 items-start">
      <!-- Text -->
      <div>
        <p class="section-label">
          Getting Started
        </p>
        <h2 class="mt-4 text-3xl font-semibold text-[var(--text-primary)] md:text-4xl">
          Ready for your AI Cofounder?
        </h2>
        <p class="mt-4 text-[var(--text-muted)] leading-relaxed">
          Run <code class="text-[var(--accent)] bg-[var(--surface)] px-2 py-0.5 border border-[var(--border)]">/onboarding</code> and answer a few questions.
          OpenAgent learns who you are, what you're building, and how you work best.
        </p>
        <p class="mt-4 text-[var(--text-muted)] leading-relaxed">
          Everything is modular. Skip what you don't need. Everyone works differently.
        </p>

        <div class="mt-8 space-y-4">
          <div class="flex items-start gap-4 group">
            <div class="flex-shrink-0 border border-[var(--border)] bg-[var(--surface)] p-2 group-hover:border-[var(--accent)]/30 transition-colors">
              <MessageSquare class="h-4 w-4 text-[var(--text-muted)] group-hover:text-[var(--accent)] transition-colors" />
            </div>
            <div>
              <p class="font-medium text-[var(--text-primary)]">Interactive questions</p>
              <p class="text-sm text-[var(--text-muted)]">Work areas, goals, preferences, tech stack</p>
            </div>
          </div>
          <div class="flex items-start gap-4 group">
            <div class="flex-shrink-0 border border-[var(--border)] bg-[var(--surface)] p-2 group-hover:border-[var(--accent)]/30 transition-colors">
              <FileText class="h-4 w-4 text-[var(--text-muted)] group-hover:text-[var(--accent)] transition-colors" />
            </div>
            <div>
              <p class="font-medium text-[var(--text-primary)]">Auto-generates your system</p>
              <p class="text-sm text-[var(--text-muted)]">AGENT.md, tasks, memory. All set up for you</p>
            </div>
          </div>
          <div class="flex items-start gap-4 group">
            <div class="flex-shrink-0 border border-[var(--border)] bg-[var(--surface)] p-2 group-hover:border-[var(--accent)]/30 transition-colors">
              <Sparkles class="h-4 w-4 text-[var(--text-muted)] group-hover:text-[var(--accent)] transition-colors" />
            </div>
            <div>
              <p class="font-medium text-[var(--text-primary)]">Ready to go</p>
              <p class="text-sm text-[var(--text-muted)]">Start with /openagent and full context loaded</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Terminal Preview + Skill CTA -->
      <div class="space-y-6">
        <div class="relative">
          <!-- Glow effect -->
          <div class="absolute -inset-2 bg-gradient-to-br from-[var(--accent-glow)] to-transparent opacity-30 blur-xl"></div>

          <div class="relative border border-[var(--border)] bg-[var(--surface)]">
            <div class="flex items-center gap-2 border-b border-[var(--border)] px-4 py-3">
              <span class="w-3 h-3 rounded-full bg-[var(--accent)]"></span>
              <span class="w-3 h-3 rounded-full bg-[var(--text-faded)]/30"></span>
              <span class="w-3 h-3 rounded-full bg-[var(--text-faded)]/30"></span>
              <span class="ml-3 text-xs text-[var(--text-faded)]">onboarding</span>
              <span class="ml-auto text-[10px] font-mono text-[var(--text-faded)]" id="question-counter">1/5</span>
            </div>
            <div class="p-6 text-sm">
              <div class="space-y-4">
                <div>
                  <span class="text-[var(--accent)]">$</span>
                  <span class="text-[var(--text-primary)] ml-2">/onboarding</span>
                </div>
                <div class="text-[var(--text-muted)]">
                  <p>Welcome to OpenAgent!</p>
                  <p class="mt-2">I'll ask you a few questions to personalize your system.</p>
                </div>
                <div class="mt-4 border border-[var(--border)] bg-[var(--background)] p-3">
                  <p class="text-[var(--text-primary)]" id="current-question">What's your name?</p>
                  <div class="mt-2 flex gap-2">
                    <span class="border border-[var(--border)] px-2 py-1 text-xs text-[var(--text-muted)] hover:border-[var(--text-muted)] transition-colors cursor-pointer">Skip</span>
                    <span class="border border-[var(--accent)] px-2 py-1 text-xs text-[var(--accent)]" id="current-placeholder">Type your name...</span>
                  </div>
                </div>
                <!-- Navigation -->
                <div class="flex items-center justify-between pt-2">
                  <button id="prev-question" class="flex items-center gap-1 text-xs text-[var(--text-muted)] hover:text-[var(--text-primary)] transition-colors disabled:opacity-30 disabled:cursor-not-allowed" disabled>
                    <ChevronLeft class="h-4 w-4" />
                    <span>Previous</span>
                  </button>
                  <div class="flex gap-1" id="question-dots">
                    {onboardingQuestions.map((_, i) => (
                      <span class={`w-1.5 h-1.5 rounded-full ${i === 0 ? 'bg-[var(--accent)]' : 'bg-[var(--text-faded)]/30'}`} data-dot={i}></span>
                    ))}
                  </div>
                  <button id="next-question" class="flex items-center gap-1 text-xs text-[var(--text-muted)] hover:text-[var(--text-primary)] transition-colors">
                    <span>Next</span>
                    <ChevronRight class="h-4 w-4" />
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Or load Skill CTA -->
        <div class="text-center">
          <p class="text-sm text-[var(--text-muted)] mb-3">Download the repo, run /onboarding and get started</p>
          <a
            href="#install"
            class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium border border-[var(--accent)]/30 bg-[var(--surface)]/50 text-[var(--text-primary)] hover:border-[var(--accent)]/60 hover:bg-[var(--surface)] transition-all"
          >
            <Zap class="h-4 w-4 text-[var(--accent)]" />
            <span>cd && curl -fsSL https://open-agent.sh/install | bash</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const onboardingQuestions = [
    { question: "What's your name?", placeholder: "Type your name..." },
    { question: "What are your main work areas?", placeholder: "e.g., Web development, AI/ML..." },
    { question: "What are you currently building?", placeholder: "Describe your current project..." },
    { question: "What do you want to achieve this week?", placeholder: "Your goals..." },
    { question: "Which agents would be most useful?", placeholder: "e.g., /research, /opencode..." }
  ];

  let currentIndex = 0;
  const questions = onboardingQuestions;

  const questionEl = document.getElementById('current-question');
  const placeholderEl = document.getElementById('current-placeholder');
  const counterEl = document.getElementById('question-counter');
  const prevBtn = document.getElementById('prev-question') as HTMLButtonElement;
  const nextBtn = document.getElementById('next-question') as HTMLButtonElement;
  const dots = document.querySelectorAll('[data-dot]');

  function updateQuestion() {
    if (questionEl) questionEl.textContent = questions[currentIndex].question;
    if (placeholderEl) placeholderEl.textContent = questions[currentIndex].placeholder;
    if (counterEl) counterEl.textContent = `${currentIndex + 1}/${questions.length}`;

    // Update dots
    dots.forEach((dot, i) => {
      if (i === currentIndex) {
        dot.classList.remove('bg-[var(--text-faded)]/30');
        dot.classList.add('bg-[var(--accent)]');
      } else {
        dot.classList.remove('bg-[var(--accent)]');
        dot.classList.add('bg-[var(--text-faded)]/30');
      }
    });

    // Update button states
    if (prevBtn) {
      prevBtn.disabled = currentIndex === 0;
    }
    if (nextBtn) {
      nextBtn.disabled = currentIndex === questions.length - 1;
    }
  }

  prevBtn?.addEventListener('click', () => {
    if (currentIndex > 0) {
      currentIndex--;
      updateQuestion();
    }
  });

  nextBtn?.addEventListener('click', () => {
    if (currentIndex < questions.length - 1) {
      currentIndex++;
      updateQuestion();
    }
  });

  // Auto-advance every 4 seconds
  setInterval(() => {
    currentIndex = (currentIndex + 1) % questions.length;
    updateQuestion();
  }, 4000);
</script>
